--- origsrc/Mesa-7.11.2/configure.ac	2011-10-14 19:43:58.000000000 -0500
+++ src/Mesa-7.11.2/configure.ac	2011-12-23 01:08:39.566908900 -0600
@@ -137,21 +137,6 @@ _SAVE_CPPFLAGS="$CPPFLAGS"
 AC_ARG_VAR([X11_INCLUDES],[Extra -I paths for X11 headers])
 AC_SUBST([X11_INCLUDES])
 
-dnl Compiler macros
-DEFINES=""
-AC_SUBST([DEFINES])
-case "$host_os" in
-linux*|*-gnu*|gnu*)
-    DEFINES="$DEFINES -D_GNU_SOURCE -DPTHREADS"
-    ;;
-solaris*)
-    DEFINES="$DEFINES -DPTHREADS -DSVR4"
-    ;;
-cygwin*)
-    DEFINES="$DEFINES -DPTHREADS"
-    ;;
-esac
-
 dnl Add flags for gcc and g++
 if test "x$GCC" = xyes; then
     CFLAGS="$CFLAGS -Wall -Wmissing-prototypes -std=c99"
@@ -191,6 +176,23 @@ if test "x$GXX" = xyes; then
     CXXFLAGS="$CXXFLAGS -fno-strict-aliasing"
 fi
 
+dnl Compiler macros
+DEFINES=""
+case "$host_os" in
+linux*|*-gnu*|gnu*)
+    DEFINES="$DEFINES -D_GNU_SOURCE -DPTHREADS"
+    ;;
+solaris*)
+    DEFINES="$DEFINES -DPTHREADS -DSVR4"
+    ;;
+cygwin*)
+    DEFINES="$DEFINES -D_GNU_SOURCE -DPTHREADS"
+    VISIBILITY_CFLAGS=""
+    VISIBILITY_CXXFLAGS=""
+    ;;
+esac
+
+AC_SUBST([DEFINES])
 AC_SUBST([VISIBILITY_CFLAGS])
 AC_SUBST([VISIBILITY_CXXFLAGS])
 
