--- origsrc/mesa-17.0.3/src/gallium/auxiliary/util/u_dl.h	2017-04-01 10:33:37.000000000 -0500
+++ src/mesa-17.0.3/src/gallium/auxiliary/util/u_dl.h	2017-04-03 23:56:26.657477100 -0500
@@ -42,6 +42,9 @@ extern "C" {
 #elif defined(PIPE_OS_APPLE)
 #  define UTIL_DL_EXT ".dylib"
 #  define UTIL_DL_PREFIX "lib"
+#elif defined(PIPE_OS_CYGWIN)
+#  define UTIL_DL_EXT ".dll"
+#  define UTIL_DL_PREFIX "cyg"
 #else
 #  define UTIL_DL_EXT ".so"
 #  define UTIL_DL_PREFIX "lib"
--- origsrc/mesa-17.0.3/src/gallium/drivers/swr/rasterizer/common/os.h	2017-04-01 10:33:37.000000000 -0500
+++ src/mesa-17.0.3/src/gallium/drivers/swr/rasterizer/common/os.h	2017-04-04 01:55:20.658426200 -0500
@@ -77,7 +77,7 @@ static inline void AlignedFree(void* p)
 #define _mm_popcount_sizeT _mm_popcnt_u32
 #endif
 
-#elif defined(__APPLE__) || defined(FORCE_LINUX) || defined(__linux__) || defined(__gnu_linux__)
+#elif defined(__APPLE__) || defined(FORCE_LINUX) || defined(__linux__) || defined(__gnu_linux__) || defined(__CYGWIN__)
 
 #define SWR_API
 
@@ -219,8 +219,12 @@ void AlignedFree(void* p)
 #define sprintf_s sprintf
 #define strcpy_s(dst,size,src) strncpy(dst,src,size)
 #define GetCurrentProcessId getpid
+#ifdef __CYGWIN__
+extern "C" uint32_t __stdcall GetCurrentThreadId(void);
+#else
 pid_t gettid(void);
 #define GetCurrentThreadId gettid
+#endif
 
 #define CreateDirectory(name, pSecurity) mkdir(name, 0777)
 
--- origsrc/mesa-17.0.3/src/gallium/drivers/swr/rasterizer/core/threads.cpp	2017-04-01 10:33:37.000000000 -0500
+++ src/mesa-17.0.3/src/gallium/drivers/swr/rasterizer/core/threads.cpp	2017-04-04 00:11:12.565598700 -0500
@@ -30,7 +30,7 @@
 #include <fstream>
 #include <string>
 
-#if defined(__linux__) || defined(__gnu_linux__)
+#if defined(__linux__) || defined(__gnu_linux__) || defined(__CYGWIN__)
 #include <pthread.h>
 #include <sched.h>
 #include <unistd.h>
@@ -158,7 +158,7 @@ void CalculateProcessorTopology(CPUNumaN
     free(pBufferMem);
 
 
-#elif defined(__linux__) || defined (__gnu_linux__)
+#elif defined(__linux__) || defined (__gnu_linux__) || defined(__CYGWIN__)
 
     // Parse /proc/cpuinfo to get full topology
     std::ifstream input("/proc/cpuinfo");
@@ -283,7 +283,7 @@ void bindThread(SWR_CONTEXT* pContext, u
 
     SetThreadGroupAffinity(GetCurrentThread(), &affinity, nullptr);
 
-#else
+#elif !defined(__CYGWIN__)
 
     cpu_set_t cpuset;
     pthread_t thread = pthread_self();
